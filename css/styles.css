:root{
  --wine:#7d1128;         /* primary accent */
  --olive:#6a994e;        /* success */
  --silver:#c7c9d3;       /* muted on dark */
  --silver-strong:#e2e4ea;/* brighter for readability */
  --ink:#0b0b0c;          /* bg dark */
  --paper:#f7f7f8;        /* bg light */
  --text-dark:#0d0e10;
  --text-light:#f2f4f8;
  --radius:14px;
  --shadow:0 20px 60px rgba(0,0,0,.35);
  --elev:0 10px 30px rgba(0,0,0,.25);
  --container:1100px;
  --focus:2px solid color-mix(in srgb, var(--wine) 65%, white 35%);
  font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  color-scheme: dark light;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(1200px 600px at 10% 10%, rgba(125,17,40,.12), transparent 60%),
    linear-gradient(180deg, #0b0b0c, #0b0b0c 60%, #0f1115);
  color:var(--text-light);
  line-height:1.5;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  font-size:18px;
}

.container{max-width:var(--container); margin:0 auto; padding:0 20px}

/* Header */
.site-header{position:sticky; top:0; z-index:50; backdrop-filter:blur(8px); background:rgba(10,10,12,.35); border-bottom:1px solid rgba(255,255,255,.06)}
.header-inner{display:flex; align-items:center; justify-content:space-between; padding:14px 0}
.brand{display:flex; align-items:center; gap:10px; color:inherit; text-decoration:none; font-weight:800}
.logo{width:32px; height:32px; color:var(--wine)}
.brand-text{letter-spacing:.2px}
.nav a{color:var(--silver); text-decoration:none; margin:0 10px; font-weight:700}
.nav a:hover,.nav a:focus{color:var(--text-light); outline:none}
.header-actions{display:flex; gap:8px}

/* Buttons */
.btn{border:0; border-radius:10px; padding:12px 16px; cursor:pointer; font-size:1rem;
  transition:transform .12s ease, box-shadow .12s ease, background .2s ease, border-color .2s ease}
.btn.primary{background:linear-gradient(90deg,var(--wine), #b72348); color:white; box-shadow:var(--elev)}
.btn.primary:hover{ box-shadow:0 12px 30px rgba(125,17,40,.35); transform:translateY(-1px) }
.btn.ghost{background:transparent; border:1px solid rgba(255,255,255,.12); color:var(--text-light)}
.btn.ghost:hover{border-color:rgba(255,255,255,.26)}
.btn.success{background:linear-gradient(90deg,var(--olive), #98c27a); color:#0b150b}
.btn.success:hover{box-shadow:0 12px 30px rgba(106,153,78,.28); transform:translateY(-1px)}
.btn:active{transform:translateY(1px)}

/* Parallax background layers */
.bg-parallax{position:fixed; inset:0; z-index:-1; overflow:hidden}
.bg-layer{position:absolute; inset:-10%; background:radial-gradient(400px 200px at 70% 30%, rgba(255,255,255,.05), transparent 60%)}
.l1{animation:float1 30s linear infinite; transform:translateZ(0)}
.l2{animation:float2 60s linear infinite; mix-blend-mode:screen}
.l3{animation:float3 90s linear infinite; mix-blend-mode:screen}
@keyframes float1{to{transform:translateX(200px) translateY(80px)}}
@keyframes float2{to{transform:translateX(-250px) translateY(-120px)}}
@keyframes float3{to{transform:translateX(220px) translateY(-200px)}}

/* Skip link */
.skip-link{position:absolute; left:-999px; top:auto; width:1px; height:1px; overflow:hidden}
.skip-link:focus{left:10px; top:10px; width:auto; height:auto; background:var(--paper); color:var(--text-dark); padding:8px 12px; border-radius:8px}

/* Sections & cards */
.section{padding:56px 0}
.card{background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08); box-shadow:var(--elev); border-radius:var(--radius); padding:18px; color:var(--text-light)}
.card h3{margin:10px 0 8px}

/* Landing hero */
.hero{display:grid; grid-template-columns:1.2fr .8fr; gap:28px; align-items:center; min-height:60vh; padding:64px 0; row-gap:18px}
.hero h1{font-size:2.6rem; line-height:1.05; margin:.2rem 0 .6rem}
.hero .lead{color:var(--silver-strong); font-size:1.05rem}
.hero .cta{display:flex; gap:12px; margin-top:16px}

/* Dashboard */
.grid{display:grid; grid-template-columns:repeat(3,1fr); gap:16px}
.kpi{display:grid; gap:6px}
.kpi .big{font-size:1.6rem; font-weight:800}
.badges{display:flex; gap:10px; flex-wrap:wrap}
.badge{background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02)); border:1px solid rgba(255,255,255,.08); padding:8px 10px; border-radius:999px; font-weight:700}
.badge.unlocked{border-color:color-mix(in srgb, var(--olive) 50%, white 50%); color:#cfe8cc}

/* Library */
.toolbar{display:flex; gap:8px; align-items:center; justify-content:space-between; margin-bottom:14px}
.search{flex:1}
.search input{width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.1); background:rgba(255,255,255,.04); color:var(--text-light)}
.tag{padding:6px 10px; border-radius:999px; border:1px solid rgba(255,255,255,.12); color:var(--silver); font-weight:700; font-size:.9rem}
.library{display:grid; grid-template-columns:repeat(2,1fr); gap:16px}
.f-card{position:relative; overflow:hidden; border-radius:var(--radius); cursor:pointer}
.f-card .pill{position:absolute; top:10px; right:10px; background:rgba(0,0,0,.35); padding:6px 10px; border-radius:999px; font-size:.8rem}
.f-card:hover{transform:translateY(-2px); transition:transform .15s ease}

/* Modal */
.modal{position:fixed; inset:0; display:grid; place-items:center; background:rgba(8,10,14,.55); backdrop-filter:blur(6px)}
.modal.hidden{display:none}
.modal-card{background:var(--ink); border:1px solid rgba(255,255,255,.12); border-radius:14px; width:min(860px, 94vw); max-height:86vh; overflow:auto; box-shadow:var(--shadow); padding:18px; position:relative; overscroll-behavior:contain}
.modal-close{position:absolute; top:10px; right:10px; width:36px; height:36px; display:grid; place-items:center; border-radius:8px}
.modal-close:hover{background:rgba(255,255,255,.06)}

/* Practice */
.practice{display:grid; gap:14px}
.hud{display:flex; gap:10px; align-items:center; justify-content:space-between}
.progress{height:8px; width:100%; background:rgba(255,255,255,.08); border-radius:999px; overflow:hidden; position:relative}
.progress > span{display:block; height:100%; background:linear-gradient(90deg,var(--olive), #a9d992 60%, #98c27a); width:0%; transition:width .35s ease}
.scenario{padding:18px; border-radius:var(--radius); background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08)}
.options{display:grid; gap:10px}
.option{padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,.08); background:rgba(255,255,255,.03); cursor:pointer; text-align:left}
.option:hover,.option:focus{outline:none; border-color:rgba(255,255,255,.18)}
.option.correct{animation:flash-green .4s ease; border-color:color-mix(in srgb, var(--olive) 55%, white 45%); background:color-mix(in srgb, var(--olive) 18%, transparent)}
.option.wrong{animation:flash-red .4s ease; border-color:color-mix(in srgb, var(--wine) 65%, white 35%); background:color-mix(in srgb, var(--wine) 16%, transparent)}
.feedback{color:var(--silver)}
@keyframes flash-green{0%{box-shadow:0 0 0 0 rgba(106,153,78,.6)}100%{box-shadow:0 0 0 16px rgba(106,153,78,0)}}
@keyframes flash-red{0%{box-shadow:0 0 0 0 rgba(125,17,40,.6)}100%{box-shadow:0 0 0 16px rgba(125,17,40,0)}}

/* Profile */
.charts{display:grid; grid-template-columns:1fr 1fr; gap:14px}
.ring{--p:64; position:relative; width:160px; aspect-ratio:1; border-radius:50%; background:
  conic-gradient(var(--olive) calc(var(--p)*1%), rgba(255,255,255,.12) 0); display:grid; place-items:center; margin:auto}
.ring::after{content:""; width:120px; aspect-ratio:1; background:inherit; border-radius:50%; position:absolute}
.ring span{position:relative; font-weight:800}
.bar{height:10px; background:rgba(255,255,255,.1); border-radius:999px; overflow:hidden}
.bar > span{display:block; height:100%; background:linear-gradient(90deg,var(--wine), #d04a67); width:0%}

/* Typography */
h1,h2,h3,h4{margin:.2rem 0 .4rem}
h2{font-size:1.25rem}
.lead{color:var(--silver-strong)}
a{color:inherit}

/* Focus visible */
:where(a, button, input, [tabindex]){:focus{outline:none}}
:where(a, button, input, [tabindex]){:focus-visible{outline:var(--focus); outline-offset:3px}}

/* Theme */
body.theme-light{
  background:linear-gradient(180deg,#f7f7f8,#eef0f4); color:#111318
}
body.theme-light .card,
body.theme-light .scenario{background:#fff; color:#111318; border:1px solid #e2e4ea; box-shadow:0 12px 30px rgba(0,0,0,.06)}
body.theme-light .modal-card{background:#fff; color:#111318; border:1px solid #e2e4ea; box-shadow:0 24px 60px rgba(0,0,0,.12)}
body.theme-light .tag{border-color:#e2e4ea; color:#333b48}
body.theme-light .search input{background:#fff; border-color:#e2e4ea; color:#111318}
body.theme-light .btn.ghost{border-color:#d7dae4; color:#111318}
body.theme-light .btn.ghost:hover{border-color:#c9cddd; background:#f8f9fb}
body.theme-light .option{background:#fff; border-color:#e2e4ea}
body.theme-light .option:hover, body.theme-light .option:focus{border-color:#cfd3df}
body.theme-light .option.correct{background:#eef7ea; border-color:#b7df9f}
body.theme-light .option.wrong{background:#fdecef; border-color:#f0b3c0}
body.theme-light .ring{background:conic-gradient(#6a994e calc(var(--p)*1%), #e7e9ef 0)}
body.theme-light .ring::after{background:#fff}
body.theme-light .modal-close:hover{background:#f1f2f6}
body.theme-light .site-header{background:rgba(255,255,255,.75); border-bottom:1px solid #e2e4ea}
body.theme-light .nav a{color:#5a6270}
body.theme-light .nav a:hover, body.theme-light .nav a:focus{color:#111318}

/* Responsive */
@media (max-width:980px){
  .hero{grid-template-columns:1fr}
  .library{grid-template-columns:1fr}
  .grid{grid-template-columns:1fr}
  .charts{grid-template-columns:1fr}
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  *,*::before,*::after{animation:none !important; transition:none !important}
  .bg-parallax{display:none}
}

/* Scrollbar styling */
*{scrollbar-width:thin; scrollbar-color:rgba(255,255,255,.3) transparent}
*::-webkit-scrollbar{height:10px; width:10px}
*::-webkit-scrollbar-thumb{background:rgba(255,255,255,.28); border-radius:999px}
*::-webkit-scrollbar-track{background:transparent}
body.theme-light *{scrollbar-color:#cfd3df transparent}
body.theme-light *::-webkit-scrollbar-thumb{background:#cfd3df}

/* ---------- Fix 1: Practice option readability ---------- */
.practice .scenario h3{
  font-size: 1.25rem;
  line-height: 1.25;
}
.practice .scenario .lead{
  font-size: 1.05rem;
  line-height: 1.5;
}
.practice .option{
  font-size: 1.05rem;     /* bigger text */
  line-height: 1.4;       /* more breathing room */
  padding: 16px 14px;     /* larger tap target */
}

/* ---------- Fix 2: “Most missed” cards layout ---------- */
/* Make non-KPI cards stack nicely and avoid crowding */
.grid .card:not(.kpi){
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.grid .card:not(.kpi) .lead{
  margin: 0;              /* remove accidental extra spacing */
}
.grid .card:not(.kpi) .btn{
  display: inline-block;  /* keep button on its own line */
  align-self: flex-start; /* avoid stretching full width */
  margin-top: 4px;
}

/* If you want to ensure long fallacy names wrap cleanly */
.grid .card:not(.kpi) strong{
  word-wrap: break-word;
  overflow-wrap: anywhere;
}

/* ---------- Fix 3: Ring % text visibility ---------- */
/* Make inner disc solid + behind the text; keep text above everything */
.ring{
  position: relative;
}
.ring::after{
  content: "";
  position: absolute;
  inset: 20px;            /* equals 120px circle when ring is 160px */
  border-radius: 50%;
  background: var(--ink); /* solid inner disc in dark mode */
  z-index: 0;
}
.ring span{
  position: relative;
  z-index: 1;             /* ensure % text is above the disc/gradient */
}

/* Light theme inner disc should be white, not inherited */
body.theme-light .ring::after{
  background: #fff;
}

/* Optional: slightly larger ring text for clarity */
.ring span{
  font-size: 1.15rem;
  font-weight: 800;
}

/* ---------- Small polish: progress bar animation smoothness ---------- */
.progress > span{
  transition: width .35s ease;
}

/* ---------- Optional: mobile tweaks for practice ---------- */
@media (max-width: 480px){
  .practice .option{
    font-size: 1.075rem;
    line-height: 1.45;
    padding: 16px;
  }
}
/* =========================
   LIGHT THEME CONTRAST FIX
   Paste at bottom of CSS
   ========================= */

/* Global light text colors */
body.theme-light {
  color: #121316;
}
body.theme-light .lead {
  /* from very light grey -> readable on white */
  color: #4a4f57; /* ~WCAG AA on white */
}

/* Header & nav */
body.theme-light .site-header {
  background: rgba(255,255,255,.75);
  border-bottom: 1px solid #e6e7eb;
  backdrop-filter: blur(8px);
}
body.theme-light .nav a {
  color: #4b5563; /* slate-600 */
}
body.theme-light .nav a:hover,
body.theme-light .nav a:focus {
  color: #111827; /* near-black */
}

/* Cards & sections already set to white in your CSS, keep borders darker */
body.theme-light .card,
body.theme-light .scenario {
  background: #ffffff;
  color: #121316;
  border: 1px solid #e2e5ec;
}

/* Inputs */
body.theme-light .search input {
  background: #ffffff;
  color: #111827;
  border: 1px solid #d1d5db;  /* gray-300 */
}
body.theme-light .search input::placeholder {
  color: #6b7280; /* gray-500 */
}

/* Tags / Pills */
body.theme-light .tag {
  color: #374151;             /* gray-700 */
  border: 1px solid #d1d5db;  /* gray-300 */
  background: #f3f4f6;        /* gray-100 */
}

/* Library cards */
body.theme-light .f-card .pill {
  background: rgba(0,0,0,.06);
  color: #111827;
}

/* Buttons */
body.theme-light .btn.ghost {
  color: #111827;
  border: 1px solid #d1d5db;
  background: #ffffff;
}
body.theme-light .btn.success {
  color: #0b150b; /* keep */
}

/* Practice: options need stronger contrast on white */
body.theme-light .option {
  background: #ffffff;
  color: #111827;
  border: 1px solid #e5e7eb;
}
body.theme-light .option:hover,
body.theme-light .option:focus {
  border-color: #c9ced8;      /* slightly darker on hover */
}
body.theme-light .option.correct {
  border-color: #7bb27a;
  background: #e7f5e7;        /* light green */
}
body.theme-light .option.wrong {
  border-color: #e59aa8;
  background: #fde7ec;        /* light red */
}

/* HUD / progress */
body.theme-light .progress {
  background: #e9ecf2;        /* light track */
}
body.theme-light .progress > span {
  background: linear-gradient(90deg, var(--olive), #9bd18a);
}

/* Badges */
body.theme-light .badge {
  border: 1px solid #e5e7eb;
  background: linear-gradient(180deg, #ffffff, #f9fafb);
  color: #1f2937;
}
body.theme-light .badge.unlocked {
  border-color: #b9e2b1;
  color: #236c2d;
}

/* “Most missed” card layout guard (keeps button on new line) */
.grid .card:not(.kpi){
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.grid .card:not(.kpi) .btn{
  align-self: flex-start;
}

/* Donut ring: ensure inner disc is SOLID & behind text */
.ring { position: relative; }
.ring::after{
  content: "";
  position: absolute;
  inset: 20px;
  border-radius: 50%;
  background: #fff;  /* solid white in light mode */
  z-index: 0;
}
.ring span{
  position: relative;
  z-index: 1;        /* % label above everything */
  font-size: 1.15rem;
  font-weight: 800;
}

/* Inputs/links inside modal should inherit proper contrast */
body.theme-light .modal-card {
  background:#fff; color:#121316; border:1px solid #e6e7eb;
}

/* Minor: make practice text a bit bigger in both themes for readability */
.practice .scenario h3 { font-size: 1.25rem; line-height: 1.25; }
.practice .scenario .lead { font-size: 1.05rem; line-height: 1.5; }
.practice .option { font-size: 1.05rem; line-height: 1.4; padding: 16px 14px; }

/* Smooth progress fill */
.progress > span{ transition: width .35s ease; }
/* ===== LIBRARY CARD COLOR POP (both themes) ===== */
.f-card {
  position: relative;
  overflow: hidden;
}
.f-card::before{
  content:"";
  position:absolute; inset:0;
  /* radial “spotlight” in top-left + diagonal tint */
  background:
    radial-gradient(420px 260px at 12% 10%, rgba(255,255,255,.06), transparent 60%),
    linear-gradient(130deg, rgba(255,255,255,.04), rgba(255,255,255,0) 55%);
  pointer-events:none;
}

/* Dark: let the color wash be stronger */
body.theme-dark .f-card{
  border: 1px solid rgba(255,255,255,.10);
  box-shadow: 0 18px 60px rgba(0,0,0,.45);
}
body.theme-dark .f-card::before{
  background:
    radial-gradient(480px 300px at 12% 10%, rgba(255,255,255,.10), transparent 62%),
    linear-gradient(120deg, rgba(255,255,255,.06), rgba(255,255,255,0) 58%);
}

/* Light: stronger tint so it’s not “bleak” */
body.theme-light .f-card{
  border: 1px solid #dfe3eb;
  box-shadow: 0 14px 34px rgba(10,20,30,.08);
}
body.theme-light .f-card::before{
  background:
    radial-gradient(520px 320px at 12% 10%, rgba(0,0,0,.05), transparent 62%),
    linear-gradient(120deg, rgba(0,0,0,.04), rgba(0,0,0,0) 58%);
}

/* “Difficulty” pill legibility in light mode */
body.theme-light .f-card .pill{
  background: rgba(0,0,0,.08);
  color:#111827;
}

/* ===== SEARCH BAR (shorter placeholder + bigger font) ===== */
.search input{
  font-size: 1.05rem;
  line-height: 1.35;
  padding: 12px 14px;
}
.search input::placeholder{ opacity:.9; }

/* ===== PRACTICE READABILITY ===== */
.practice .hud{ row-gap: 6px; }
.practice .scenario h3{ font-size: 1.32rem; line-height: 1.28; }
.practice .scenario .lead{ font-size: 1.12rem; line-height: 1.55; }
.practice .option{ font-size: 1.08rem; line-height: 1.45; padding: 16px 14px; }

/* “Pick the best explanation” contrast */
.feedback{ color: #cfd3db; }
body.theme-light .feedback{ color:#4a4f57; }

/* ===== PROFILE SPACING & LEGIBILITY ===== */
.charts .card .lead{ margin-top: 6px; }

/* Ring label and spacing below the donut */
.ring span{ font-size: 1.2rem; font-weight: 800; }
.charts .card:first-child .lead{
  margin-top: 10px; /* more breathing room under the ring */
}

/* “Most missed” cards: stack neatly, button on its own line */
.grid .card:not(.kpi){
  display: flex; flex-direction: column; align-items: flex-start;
  gap: 8px;
}
.grid .card:not(.kpi) .lead{ margin: 0; }
.grid .card:not(.kpi) .btn{ align-self: flex-start; }

/* Extra vertical spacing between rows in that grid so nothing overlaps */
.section .grid{ row-gap: 18px; }

/* ===== LIGHT THEME CONTRAST (keeps everything readable) ===== */
body.theme-light .lead{ color:#4a4f57; }
body.theme-light .option{ background:#fff; color:#111827; border:1px solid #e5e7eb; }
body.theme-light .option:hover,
body.theme-light .option:focus{ border-color:#c9ced8; }
body.theme-light .option.correct{ border-color:#7bb27a; background:#e7f5e7; }
body.theme-light .option.wrong{ border-color:#e59aa8; background:#fde7ec; }
body.theme-light .progress{ background:#e9ecf2; }
/* ===== PROFILE: RING PERCENTAGE VISIBILITY & SIZE ===== */
.ring span{
  font-size: 1.6rem;          /* bigger number */
  font-weight: 900;
  letter-spacing: .2px;
}

/* Dark theme: brighter number with subtle glow so it never gets “eaten” by the wedge */
body.theme-dark .ring span{
  color: #f8fafc;             /* near-white */
  text-shadow: 0 1px 2px rgba(0,0,0,.6), 0 0 2px rgba(0,0,0,.5);
}

/* Light theme: darker number with light glow for separation */
body.theme-light .ring span{
  color: #0f172a;             /* very dark slate */
  text-shadow: 0 1px 2px rgba(255,255,255,.6), 0 0 2px rgba(255,255,255,.8);
}

/* Extra breathing room for the label under the ring */
.charts .card:first-child .lead{
  margin-top: 14px;           /* was 10; push it down a bit more */
  line-height: 1.35;
}

/* ===== PROFILE: “MOST MISSED” GRID NOT CROWDED ===== */
/* Give that grid more vertical separation so any divider/footnote lines don’t overlap cards */
.section .grid{
  row-gap: 22px;              /* roomier */
  margin-bottom: 28px;        /* pushes any following divider well below the last row */
}

/* Make each card naturally stack: title, stats, then button on its own line */
.section .grid .card:not(.kpi){
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 10px;                  /* a bit more space between lines */
}

/* The little stats line isn’t faint in dark mode */
body.theme-dark .section .grid .card .lead{
  color: #d7dbe3;
}

/* Ensure buttons don’t squeeze horizontally next to text */
.section .grid .card .btn{
  align-self: flex-start;
}

/* If you happen to use any <hr> in Profile, make sure it sits below the grid cleanly */
.section hr{
  margin-top: 28px;
  clear: both;
  opacity: .5;
}
/* ====== MOST MISSED: keep any divider/footnote well below the grid ====== */
.most-missed-grid{
  row-gap: 22px;              /* room between cards */
  margin-bottom: 36px;        /* push following content/line further down */
  padding-bottom: 6px;        /* extra breathing room above any divider */
}

/* Ensure the button sits on its own line and spacing is clean */
.most-missed-grid .card{
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  gap: 10px;
}

/* If you use an <hr> or a pseudo-divider below sections, keep it clear */
.most-missed-grid + hr{
  margin-top: 24px !important;
}
.section hr{
  clear: both;
}

/* ====== OVERALL ACCURACY RING: dark-mode legibility ====== */
/* Make the inner disk a touch lighter in dark mode so the % always contrasts */
body.theme-dark .ring::after{
  background: #101216;                       /* lighter than page bg */
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,.06),   /* soft inner outline */
    0 0 0 1px rgba(0,0,0,.4);                /* subtle outer edge */
}

/* Beef up the number and add an outline-like shadow in dark mode */
body.theme-dark .ring span{
  color: #f9fbff;               /* near white */
  font-size: 1.7rem;            /* slightly larger than light mode */
  font-weight: 900;
  letter-spacing: .2px;
  /* four-way shadow to “stroke” the text so it never blends */
  text-shadow:
    0 1px 2px rgba(0,0,0,.7),
    1px 0 2px rgba(0,0,0,.7),
    -1px 0 2px rgba(0,0,0,.7),
    0 -1px 2px rgba(0,0,0,.7);
}

/* Add a little more space under the ring label so it doesn’t touch the donut */
.charts .card:first-child .lead{
  margin-top: 16px;           /* was tighter; give it breathing room */
  line-height: 1.35;
}
/* === Header sizing + centering tweaks (paste at end) === */

/* Make the header a touch taller so larger text stays centered */
.site-header {
  min-height: 68px;
}

/* Keep everything vertically centered */
.header-inner {
  align-items: center;
  padding: 16px 0; /* a bit more breathing room */
}

/* Brand title: "Bias & Fallacy Lab" */
.brand-text {
  /* Responsive but capped so it doesn't blow up on huge screens */
  font-size: clamp(1.2rem, 1.05rem + 0.7vw, 1.6rem);
  line-height: 1.1;
}

/* Nav links: Dashboard · Library · Practice · Profile */
.nav a {
  font-size: clamp(1.06rem, 0.98rem + 0.35vw, 1.25rem);
  margin: 0 14px;     /* a little more spacing */
  line-height: 1.2;
  /* keep them vertically centered with the taller header */
  display: inline-flex;
  align-items: center;
}

/* Logo can scale a bit to match the bigger brand text (optional) */
.logo {
  width: 36px;
  height: 36px;
}

/* Header emoji buttons (theme/audio) — keep them in their box */
.header-actions {
  display: flex;
  gap: 10px;
}

/* Only touch the buttons inside the header area so other buttons aren't affected */
.header-actions .btn {
  display: grid;          /* centers the emoji perfectly */
  place-items: center;    /* centers both horizontally & vertically */
  min-width: 40px;
  min-height: 40px;
  padding: 8px 10px;      /* keeps the “little box” look */
  line-height: 1;
  font-size: 1.25rem;     /* bigger emoji inside same box */
}

/* If your theme/audio buttons aren't using .btn, target by id as a fallback */
#theme-toggle, #audio-toggle {
  display: grid;
  place-items: center;
  min-width: 40px;
  min-height: 40px;
  padding: 8px 10px;
  line-height: 1;
  font-size: 1.25rem;
}

/* Keep everything centered in the header container on very small screens */
@media (max-width: 520px) {
  .brand-text { font-size: clamp(1.15rem, 1.05rem + 1.2vw, 1.35rem); }
  .nav a { margin: 0 10px; }
}
/* =========================
   LIBRARY — THEATER NOIR REPAINT
   (Paste this at the end of your CSS)
   ========================= */

/* Palette tokens reused only inside the Library scope */
.library {
  --velvet-900: #3a070c;   /* seats in shadow */
  --velvet-700: #7e0f1a;   /* rich velvet red */
  --velvet-500: #b01622;   /* dice/lipstick red */
  --bottle-900: #0c1713;   /* theater darkness */
  --bottle-800: #0f221b;
  --bottle-700: #123025;   /* deep green walls */
  --bottle-500: #1f4a3b;   /* mid green */
  --gold-400: #d6b46b;     /* marquee gold */
  --ivory-50:  #f2efe7;    /* soft white text */
  --smoke-400: rgba(255,255,255,.45);
  --shadow-strong: rgba(0,0,0,.55);
  --menthol-400: #9fd8c9;  /* subtle neon tint from city shots */
}

/* Background of the Library area = bottle-green with faint spotlight */
.library {
  background:
    radial-gradient(120% 200% at 50% -40%, rgba(214,180,107,.18), rgba(214,180,107,0) 55%),
    linear-gradient(180deg, var(--bottle-900), var(--bottle-700));
  color: var(--ivory-50);
}

/* ===== Grid & cards (keep your existing class names; this only restyles) */
.library .card,
.library .bias-card,
.library [class*="card"]:not(.header-card) {
  background:
    radial-gradient(140% 100% at 20% 0%, rgba(255,255,255,.05), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, var(--bottle-800), var(--bottle-700));
  color: var(--ivory-50);
  border: 1px solid rgba(214,180,107,.18);
  border-radius: 14px;
  box-shadow:
    0 1px 0 rgba(255,255,255,.05) inset,
    0 14px 28px -18px var(--shadow-strong);
  transition: transform .15s ease, box-shadow .25s ease, border-color .25s ease, background .3s ease;
}

.library .card:hover,
.library .bias-card:hover {
  transform: translateY(-2px);
  border-color: rgba(214,180,107,.38);
  box-shadow:
    0 0 0 3px rgba(214,180,107,.18),
    0 22px 36px -18px rgba(176,22,34,.45);
  background:
    radial-gradient(140% 100% at 20% 0%, rgba(214,180,107,.10), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, var(--velvet-700), var(--bottle-700)); /* subtle red wash */
}

.library .card:focus-within,
.library .bias-card:focus-within {
  outline: none;
  box-shadow:
    0 0 0 3px rgba(214,180,107,.35),
    0 22px 36px -18px var(--shadow-strong);
  border-color: var(--gold-400);
}

/* Titles, meta, and body copy */
.library .card h3,
.library .bias-card h3,
.library .card .title {
  color: var(--ivory-50);
  letter-spacing: .2px;
}

.library .card .meta,
.library .bias-card .meta,
.library .card .excerpt {
  color: var(--smoke-400);
}

/* ===== Tags / chips / category pills (repainted to palette) */
.library .tag,
.library .chip,
.library [class*="tag-"],
.library [class*="chip-"] {
  display: inline-flex;
  align-items: center;
  gap: .35rem;
  padding: 6px 10px;
  border-radius: 999px;
  font-size: .85rem;
  letter-spacing: .2px;
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(214,180,107,.3);
  color: var(--ivory-50);
  transition: background .25s ease, color .25s ease, border-color .25s ease, transform .08s ease;
}

.library .tag:hover,
.library .chip:hover {
  transform: translateY(-1px);
  border-color: rgba(214,180,107,.55);
  color: var(--gold-400);
}

/* ===== Category color system (apply to your existing tag/card classes or data attributes)
   You likely already mark category; these selectors cover both. */

/* Heuristics / Intuition → Velvet red  */
.library .cat-heuristics,
.library [data-category*="heuristic"] {
  background: linear-gradient(180deg, rgba(176,22,34,.22), rgba(176,22,34,.06));
  border-color: rgba(176,22,34,.65);
}

/* Social / Group / Authority → Gold  */
.library .cat-social,
.library [data-category*="social"],
.library [data-category*="authority"] {
  background: linear-gradient(180deg, rgba(214,180,107,.28), rgba(214,180,107,.08));
  border-color: rgba(214,180,107,.7);
  color: #1b160a;
}

/* Memory / Attention → Menthol neon tint  */
.library .cat-memory,
.library [data-category*="memory"],
.library [data-category*="attention"] {
  background: linear-gradient(180deg, rgba(159,216,201,.22), rgba(159,216,201,.06));
  border-color: rgba(159,216,201,.6);
  color: #0b2720;
}

/* Probability / Stats / Risk → Deep bottle-green  */
.library .cat-probability,
.library [data-category*="probab"],
.library [data-category*="risk"] {
  background: linear-gradient(180deg, rgba(31,74,59,.28), rgba(31,74,59,.08));
  border-color: rgba(31,74,59,.7);
}

/* Language / Framing / Semantics → Ivory on velvet  */
.library .cat-language,
.library [data-category*="language"],
.library [data-category*="framing"] {
  background: linear-gradient(180deg, rgba(126,15,26,.35), rgba(126,15,26,.10));
  border-color: rgba(126,15,26,.8);
  color: var(--ivory-50);
}

/* ===== Card ribbons / scores / small UI bits */
.library .badge,
.library .score,
.library .ribbon {
  background: linear-gradient(180deg, var(--velvet-500), var(--velvet-700));
  color: var(--ivory-50);
  border: 1px solid rgba(176,22,34,.65);
  box-shadow: 0 2px 10px -6px rgba(176,22,34,.6);
}

/* ===== Filters/Search bar (keep layout, just recolor) */
.library .filters,
.library .toolbar {
  background:
    radial-gradient(100% 100% at 50% 0%, rgba(214,180,107,.08), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, var(--bottle-800), var(--bottle-700));
  border: 1px solid rgba(214,180,107,.18);
  border-radius: 12px;
  box-shadow: 0 10px 22px -18px var(--shadow-strong);
}

.library .filters input[type="search"],
.library .toolbar input[type="search"],
.library .filters select,
.library .toolbar select {
  background: rgba(255,255,255,.06);
  border: 1px solid rgba(214,180,107,.25);
  color: var(--ivory-50);
}
.library .filters input::placeholder,
.library .toolbar input::placeholder { color: rgba(255,255,255,.45); }

.library .filters .btn,
.library .toolbar .btn {
  background:
    radial-gradient(120% 120% at 30% 10%, rgba(255,255,255,.06), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, var(--bottle-500), var(--bottle-700));
  border: 1px solid rgba(214,180,107,.25);
  color: var(--ivory-50);
}
.library .filters .btn:hover,
.library .toolbar .btn:hover {
  background:
    radial-gradient(120% 120% at 30% 10%, rgba(214,180,107,.12), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, var(--velvet-700), var(--velvet-900));
  color: var(--gold-400);
  border-color: rgba(214,180,107,.45);
}

/* ===== Spotlight hover on images/thumbnails inside cards */
.library .card .thumb,
.library .bias-card .thumb {
  position: relative;
  overflow: hidden;
  border-radius: 10px;
}
.library .card .thumb::after,
.library .bias-card .thumb::after {
  content: "";
  position: absolute; inset: 0;
  background: radial-gradient(120% 80% at 70% 20%, rgba(255,255,255,.08), rgba(0,0,0,0) 60%);
  mix-blend-mode: screen;
  opacity: .65;
  transition: opacity .3s ease;
}
.library .card:hover .thumb::after,
.library .bias-card:hover .thumb::after { opacity: .9; }
/* =========================
   LIBRARY THEME — DARK MODE ONLY
   (No changes to light mode)
   ========================= */
   body[data-theme="dark"] .library {
    --velvet-900: #3a070c;   /* oxblood */
    --velvet-700: #7e0f1a;   /* velvet red */
    --velvet-500: #b01622;   /* dice/lipstick */
    --wine-700:   #3c1024;   /* aubergine/wine */
    --bottle-800: #0f221b;   /* deep green wall */
    --bottle-600: #1b3b2f;   /* mid green */
    --teal-500:   #0e4d46;   /* menthol-teal */
    --gold-400:   #d6b46b;   /* marquee gold */
    --ivory-50:   #f2efe7;   /* soft white */
    --smoke-400:  rgba(255,255,255,.45);
    --shadow-strong: rgba(0,0,0,.55);
  
    background:
      radial-gradient(120% 200% at 50% -40%, rgba(214,180,107,.18), rgba(214,180,107,0) 55%),
      linear-gradient(180deg, #0c1713, #123025);
    color: var(--ivory-50);
  }
  
  /* Cards: bottle base with subtle gold spotlight; hover adds red wash */
  body[data-theme="dark"] .library .card,
  body[data-theme="dark"] .library .bias-card,
  body[data-theme="dark"] .library [class*="card"]:not(.header-card) {
    background:
      radial-gradient(140% 100% at 20% 0%, rgba(255,255,255,.05), rgba(0,0,0,0) 60%),
      linear-gradient(180deg, var(--bottle-800), #0d1a16);
    color: var(--ivory-50);
    border: 1px solid rgba(214,180,107,.18);
    border-radius: 14px;
    box-shadow:
      0 1px 0 rgba(255,255,255,.05) inset,
      0 14px 28px -18px var(--shadow-strong);
    transition: transform .15s ease, box-shadow .25s ease, border-color .25s ease, background .3s ease;
  }
  body[data-theme="dark"] .library .card:hover,
  body[data-theme="dark"] .library .bias-card:hover {
    transform: translateY(-2px);
    border-color: rgba(214,180,107,.38);
    box-shadow:
      0 0 0 3px rgba(214,180,107,.18),
      0 22px 36px -18px rgba(176,22,34,.45);
    background:
      radial-gradient(140% 100% at 20% 0%, rgba(214,180,107,.10), rgba(0,0,0,0) 60%),
      linear-gradient(180deg, var(--velvet-700), var(--bottle-800));
  }
  
  /* Tiny row-to-row tint so cards don’t feel samey even within one category */
  body[data-theme="dark"] .library .grid > *:nth-child(4n+1) { filter: saturate(1.02) brightness(1.02); }
  body[data-theme="dark"] .library .grid > *:nth-child(4n+2) { background-image:
    radial-gradient(120% 100% at 80% 10%, rgba(214,180,107,.06), transparent 60%),
    linear-gradient(180deg, var(--bottle-800), #0e1c17) !important; }
  body[data-theme="dark"] .library .grid > *:nth-child(4n+3) { background-image:
    radial-gradient(100% 100% at 15% 20%, rgba(176,22,34,.06), transparent 60%),
    linear-gradient(180deg, var(--bottle-800), #0e1c17) !important; }
  
  /* Titles/meta */
  body[data-theme="dark"] .library .card h3,
  body[data-theme="dark"] .library .bias-card h3 { color: var(--ivory-50); }
  body[data-theme="dark"] .library .card .meta,
  body[data-theme="dark"] .library .bias-card .meta { color: var(--smoke-400); }
  
  /* Chips/Tags base */
  body[data-theme="dark"] .library .tag,
  body[data-theme="dark"] .library .chip,
  body[data-theme="dark"] .library [class*="tag-"],
  body[data-theme="dark"] .library [class*="chip-"] {
    display: inline-flex; align-items: center; gap: .35rem;
    padding: 6px 10px; border-radius: 999px; font-size: .85rem; letter-spacing: .2px;
    background: rgba(255,255,255,.04);
    border: 1px solid rgba(214,180,107,.3);
    color: var(--ivory-50);
    transition: background .25s ease, color .25s ease, border-color .25s ease, transform .08s ease;
  }
  body[data-theme="dark"] .library .tag:hover,
  body[data-theme="dark"] .library .chip:hover {
    transform: translateY(-1px);
    border-color: rgba(214,180,107,.55);
    color: var(--gold-400);
  }
  
  /* ===== CATEGORY REBALANCE (less green, more velvet/wine/gold/teal) ===== */
  
  /* Heuristics (incl. Availability, Representativeness, etc.) → Velvet red */
  body[data-theme="dark"] .library .cat-heuristics,
  body[data-theme="dark"] .library [data-category*="heuristic"],
  body[data-theme="dark"] .library [data-category*="availability"] {
    background: linear-gradient(180deg, rgba(176,22,34,.30), rgba(176,22,34,.10));
    border-color: rgba(176,22,34,.70);
  }
  
  /* Probability / Base-rate / Risk → Wine/Aubergine (NOT green) */
  body[data-theme="dark"] .library .cat-probability,
  body[data-theme="dark"] .library [data-category*="probab"],
  body[data-theme="dark"] .library [data-category*="base rate"],
  body[data-theme="dark"] .library [data-category*="bayes"],
  body[data-theme="dark"] .library [data-category*="risk"] {
    background: linear-gradient(180deg, rgba(60,16,36,.30), rgba(60,16,36,.10));
    border-color: rgba(60,16,36,.70);
  }
  
  /* Authority / Social proof → Gold (keeps the warm marquee vibe) */
  body[data-theme="dark"] .library .cat-social,
  body[data-theme="dark"] .library [data-category*="authority"],
  body[data-theme="dark"] .library [data-category*="social"] {
    background: linear-gradient(180deg, rgba(214,180,107,.32), rgba(214,180,107,.12));
    border-color: rgba(214,180,107,.75);
    color: #1b160a;
  }
  
  /* Language / Framing / Semantics → Velvet base with ivory text */
  body[data-theme="dark"] .library .cat-language,
  body[data-theme="dark"] .library [data-category*="language"],
  body[data-theme="dark"] .library [data-category*="framing"] {
    background: linear-gradient(180deg, rgba(126,15,26,.35), rgba(126,15,26,.12));
    border-color: rgba(126,15,26,.80);
    color: var(--ivory-50);
  }
  
  /* Memory / Attention → Menthol-teal (cooler, distinct from gold/reds) */
  body[data-theme="dark"] .library .cat-memory,
  body[data-theme="dark"] .library [data-category*="memory"],
  body[data-theme="dark"] .library [data-category*="attention"] {
    background: linear-gradient(180deg, rgba(14,77,70,.28), rgba(14,77,70,.10));
    border-color: rgba(14,77,70,.70);
  }
  
  /* Keep exactly one family in deep bottle-green: Logic/Reasoning ops only */
  body[data-theme="dark"] .library .cat-logic,
  body[data-theme="dark"] .library [data-category*="logic"],
  body[data-theme="dark"] .library [data-category*="ad hoc"] {
    background: linear-gradient(180deg, rgba(27,59,47,.30), rgba(27,59,47,.12));
    border-color: rgba(27,59,47,.70);
  }
  /* =========================
   LIGHT MODE (your defaults)
   ========================= */

/* keep your existing light styles here exactly as before */
/* e.g. .library .card, .library .tag, etc. remain unchanged */

/* =========================
   DARK MODE OVERRIDES
   ========================= */
body[data-theme="dark"] .library {
  --velvet-900: #3a070c;   /* oxblood */
  --velvet-700: #7e0f1a;   /* velvet */
  --velvet-500: #b01622;   /* dice/lipstick */
  --wine-700:   #3c1024;   /* aubergine */
  --scarlet-600:#9b1a2e;   /* brighter red for language */
  --bottle-700: #123025;   /* deep green */
  --teal-500:   #0e4d46;   /* menthol teal */
  --gold-400:   #d6b46b;   /* marquee */
  --ivory-50:  #f2efe7;    /* soft white */
  --smoke-400: rgba(255,255,255,.45);
  --shadow-strong: rgba(0,0,0,.55);

  background:
    radial-gradient(120% 200% at 50% -40%, rgba(214,180,107,.15), transparent 55%),
    linear-gradient(180deg, #0c1713, #123025);
  color: var(--ivory-50);
}

/* Generic card base */
body[data-theme="dark"] .library .card,
body[data-theme="dark"] .library .bias-card {
  background: linear-gradient(180deg, #0f1d18, #0c1713);
  color: var(--ivory-50);
  border: 1px solid rgba(214,180,107,.18);
  border-radius: 14px;
  box-shadow:
    0 1px 0 rgba(255,255,255,.05) inset,
    0 14px 28px -18px var(--shadow-strong);
  transition: transform .15s ease, background .3s ease, border-color .25s ease;
}
body[data-theme="dark"] .library .card:hover {
  transform: translateY(-2px);
  border-color: rgba(214,180,107,.38);
  background: linear-gradient(180deg, var(--velvet-700), #0c1713);
}

/* Tags/chips base */
body[data-theme="dark"] .library .tag,
body[data-theme="dark"] .library .chip {
  background: rgba(255,255,255,.04);
  border: 1px solid rgba(214,180,107,.25);
  color: var(--ivory-50);
  transition: background .25s ease, color .25s ease;
}
body[data-theme="dark"] .library .tag:hover,
body[data-theme="dark"] .library .chip:hover {
  border-color: rgba(214,180,107,.55);
  color: var(--gold-400);
}

/* =========================
   CATEGORY COLORS — DARK MODE
   ========================= */

/* Heuristics / Availability → Velvet red */
body[data-theme="dark"] .library .cat-heuristics,
body[data-theme="dark"] .library [data-category*="heuristic"],
body[data-theme="dark"] .library [data-category*="availability"] {
  background: linear-gradient(180deg, rgba(176,22,34,.35), rgba(176,22,34,.12));
  border-color: rgba(176,22,34,.7);
}

/* Probability / Base rate / Risk → Wine / Aubergine */
body[data-theme="dark"] .library .cat-probability,
body[data-theme="dark"] .library [data-category*="probab"],
body[data-theme="dark"] .library [data-category*="base rate"],
body[data-theme="dark"] .library [data-category*="risk"] {
  background: linear-gradient(180deg, rgba(60,16,36,.35), rgba(60,16,36,.12));
  border-color: rgba(60,16,36,.7);
}

/* Authority / Social proof → Gold */
body[data-theme="dark"] .library .cat-social,
body[data-theme="dark"] .library [data-category*="authority"],
body[data-theme="dark"] .library [data-category*="social"] {
  background: linear-gradient(180deg, rgba(214,180,107,.35), rgba(214,180,107,.15));
  border-color: rgba(214,180,107,.75);
  color: #1b160a;
}

/* Language / Framing → Scarlet (brighter than heuristics) */
body[data-theme="dark"] .library .cat-language,
body[data-theme="dark"] .library [data-category*="language"],
body[data-theme="dark"] .library [data-category*="framing"] {
  background: linear-gradient(180deg, rgba(155,26,46,.35), rgba(155,26,46,.15));
  border-color: rgba(155,26,46,.75);
  color: var(--ivory-50);
}

/* Memory / Attention → Menthol teal */
body[data-theme="dark"] .library .cat-memory,
body[data-theme="dark"] .library [data-category*="memory"],
body[data-theme="dark"] .library [data-category*="attention"] {
  background: linear-gradient(180deg, rgba(14,77,70,.32), rgba(14,77,70,.14));
  border-color: rgba(14,77,70,.75);
}

/* Logic / Ad hoc → Bottle green */
body[data-theme="dark"] .library .cat-logic,
body[data-theme="dark"] .library [data-category*="logic"],
body[data-theme="dark"] .library [data-category*="ad hoc"] {
  background: linear-gradient(180deg, rgba(27,59,47,.32), rgba(27,59,47,.14));
  border-color: rgba(27,59,47,.75);
}
/* ===============================
   LIGHT MODE: reset Library to original
   (keeps your dark mode styling)
   =============================== */

/* Library surface */
body.theme-light .library{
  background: transparent;         /* remove dark theater wash */
  color: #121316;                  /* standard light text */
}

/* Library grid/cards (back to white cards with subtle shadow) */
body.theme-light .library .card,
body.theme-light .library .bias-card,
body.theme-light .library [class*="card"]:not(.header-card),
body.theme-light .f-card{
  background: #ffffff;
  color: #121316;
  border: 1px solid #e6e7eb;
  border-radius: 14px;
  box-shadow: 0 14px 34px rgba(10,20,30,.06);
}

/* Strengthen the top-left “color wash” just a bit in light mode */
body.theme-light .f-card::before{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(520px 320px at 12% 10%, rgba(0,0,0,.06), transparent 62%),
    linear-gradient(120deg, rgba(0,0,0,.05), rgba(0,0,0,0) 58%);
  pointer-events:none;
}

/* Difficulty pill on cards */
body.theme-light .f-card .pill{
  background: rgba(0,0,0,.06);
  color: #111827;
}

/* Tags / chips */
body.theme-light .library .tag,
body.theme-light .library .chip{
  background: #f3f4f6;            /* gray-100 */
  border: 1px solid #d1d5db;      /* gray-300 */
  color: #374151;                  /* gray-700 */
}

/* Toolbar/search in Library */
body.theme-light .library .toolbar,
body.theme-light .library .filters{
  background: #ffffff;
  border: 1px solid #e6e7eb;
  border-radius: 12px;
  box-shadow: 0 10px 22px -18px rgba(0,0,0,.06);
}
body.theme-light .library .toolbar input[type="search"],
body.theme-light .library .filters input[type="search"]{
  background: #ffffff;
  color: #111827;
  border: 1px solid #d1d5db;
}
body.theme-light .library .toolbar input::placeholder{
  color: #6b7280; /* gray-500 */
}

/* Hover states—keep gentle in light mode */
body.theme-light .library .card:hover,
body.theme-light .library .bias-card:hover,
body.theme-light .f-card:hover{
  transform: translateY(-2px);
  border-color: #d9dde7;
  box-shadow: 0 18px 36px -18px rgba(10,20,30,.10);
}

/* Make the “Library” area respect your original light theme colors everywhere */
body.theme-light .library h3,
body.theme-light .library .title{ color:#121316; }
body.theme-light .library .meta,
body.theme-light .library .excerpt{ color:#4a4f57; }

/* ===============================
   DARK MODE: keep the cinematic Library
   (no change needed if your dark rules already exist)
   Just ensure they are scoped like this:
   =============================== */

/* Example (your existing dark Library rules should all start with body.theme-dark .library … ) */
body.theme-dark .library { /* your noir background etc. */ }
body.theme-dark .library .card { /* bottle/velvet gradients, borders, etc. */ }
body.theme-dark .library .tag { /* dark chips */ }

/* ===============================
   RING VISIBILITY in dark mode (stronger)
   =============================== */
body.theme-dark .ring::after{
  background: #0f1217; /* slightly lighter than page bg for contrast */
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,.06),
    0 0 0 1px rgba(0,0,0,.45);
}
body.theme-dark .ring span{
  color: #f9fbff;
  font-size: 1.7rem;
  font-weight: 900;
  letter-spacing: .2px;
  text-shadow:
    0 1px 2px rgba(0,0,0,.8),
    1px 0 2px rgba(0,0,0,.8),
    -1px 0 2px rgba(0,0,0,.8),
    0 -1px 2px rgba(0,0,0,.8);
}

/* ===============================
   “Most missed” grid spacing—ensure divider/footnote sits lower
   =============================== */
.most-missed-grid{ row-gap:22px; margin-bottom:36px; padding-bottom:8px; }
.most-missed-grid .card{ display:flex; flex-direction:column; gap:10px; align-items:flex-start; }
.most-missed-grid + hr{ margin-top:28px !important; }   /* push any line further down */
.section .grid{ row-gap:22px; }                          /* general safety space in that section */
/* ========== DARK MODE — Library fixes (paste at end) ========== */

/* 1) Neutralize the grid background so gaps are not green */
body.theme-dark .library{
  background: transparent !important;   /* use the page bg behind the grid */
}

/* 2) Stronger separation between cards */
body.theme-dark .library {
  /* give the grid a bit more room so shadows/borders read */
  row-gap: 18px;
  column-gap: 18px;
}

/* Base card stays bottle-dark; keep a crisp border */
body.theme-dark .library .card,
body.theme-dark .library .bias-card,
body.theme-dark .library .f-card {
  background: linear-gradient(180deg, #0f1d18, #0c1713);
  border: 1px solid rgba(214,180,107,.28);  /* slightly brighter than before */
  box-shadow:
    0 1px 0 rgba(255,255,255,.05) inset,
    0 16px 36px -18px rgba(0,0,0,.55);
}

/* 3) Alternate, higher-contrast color washes per card
      (cycles every 4 so rows don't blend together) */
body.theme-dark .library > *:nth-child(4n+1) .card,
body.theme-dark .library > *:nth-child(4n+1) .bias-card,
body.theme-dark .library > *:nth-child(4n+1).f-card {
  background-image:
    radial-gradient(120% 80% at 18% 8%, rgba(176,22,34,.18), transparent 62%),
    linear-gradient(180deg, #0f1d18, #0c1713);
  border-color: rgba(176,22,34,.55); /* velvet red edge */
}

body.theme-dark .library > *:nth-child(4n+2) .card,
body.theme-dark .library > *:nth-child(4n+2) .bias-card,
body.theme-dark .library > *:nth-child(4n+2).f-card {
  background-image:
    radial-gradient(120% 80% at 18% 8%, rgba(214,180,107,.20), transparent 62%),
    linear-gradient(180deg, #0f1d18, #0c1713);
  border-color: rgba(214,180,107,.60); /* gold edge */
}

body.theme-dark .library > *:nth-child(4n+3) .card,
body.theme-dark .library > *:nth-child(4n+3) .bias-card,
body.theme-dark .library > *:nth-child(4n+3).f-card {
  background-image:
    radial-gradient(120% 80% at 18% 8%, rgba(14,77,70,.22), transparent 62%),
    linear-gradient(180deg, #0f1d18, #0c1713);
  border-color: rgba(14,77,70,.58); /* menthol teal edge */
}

body.theme-dark .library > *:nth-child(4n+4) .card,
body.theme-dark .library > *:nth-child(4n+4) .bias-card,
body.theme-dark .library > *:nth-child(4n+4).f-card {
  background-image:
    radial-gradient(120% 80% at 18% 8%, rgba(60,16,36,.22), transparent 62%),
    linear-gradient(180deg, #0f1d18, #0c1713);
  border-color: rgba(60,16,36,.58); /* wine edge */
}

/* 4) Make hover pop a bit more so individuality is obvious */
body.theme-dark .library .card:hover,
body.theme-dark .library .bias-card:hover,
body.theme-dark .library .f-card:hover {
  transform: translateY(-2px);
  box-shadow:
    0 0 0 3px rgba(214,180,107,.20),
    0 26px 44px -20px rgba(0,0,0,.65);
}
/* ========== LIGHT MODE — Library cinematic repaint ========== */

/* Keep the library area neutral so color lives on cards (no bleak/flat look) */
body.theme-light .library{
  background: linear-gradient(180deg,#f7f7f8,#eef0f4);
  row-gap: 18px;
  column-gap: 18px;
}

/* Base card: soft ivory with subtle inner highlight & gentle shadow */
body.theme-light .library .card,
body.theme-light .library .bias-card,
body.theme-light .library .f-card{
  position: relative;
  color: #111318;
  background:
    radial-gradient(140% 100% at 20% 0%, rgba(0,0,0,.03), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, #ffffff, #f8f9fb);
  border: 1px solid #dfe3eb;
  border-radius: 14px;
  box-shadow:
    0 1px 0 rgba(255,255,255,.8) inset,
    0 14px 34px rgba(10,20,30,.06);
  overflow: hidden; /* for the smooth overlay edge */
  transition: transform .15s ease, box-shadow .25s ease, border-color .25s ease, background .3s ease;
}

/* Smoothed color wash that fades toward the right:
   we use ::before for the tint and ::after for a wide, soft mask */
body.theme-light .library .card::before,
body.theme-light .library .bias-card::before,
body.theme-light .library .f-card::before{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background:
    radial-gradient(520px 320px at 12% 10%, rgba(0,0,0,.04), transparent 65%),
    linear-gradient(120deg, rgba(0,0,0,.035), rgba(0,0,0,0) 60%);
  mix-blend-mode:multiply;
  opacity:.9;
}
body.theme-light .library .card::after,
body.theme-light .library .bias-card::after,
body.theme-light .library .f-card::after{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  /* soft white veil that eases the tint as it travels to the right,
     avoiding an abrupt stop */
  background: linear-gradient(90deg, rgba(255,255,255,0) 55%, rgba(255,255,255,.35));
  opacity:.55;
}

/* Hover: a touch more depth and a hint of the tint color */
body.theme-light .library .card:hover,
body.theme-light .library .bias-card:hover,
body.theme-light .library .f-card:hover{
  transform: translateY(-2px);
  border-color: #d3d8e4;
  box-shadow:
    0 0 0 3px rgba(13, 110, 253, .04),
    0 20px 36px rgba(10,20,30,.10);
}

/* ===== Stronger but tasteful per-card tints (alternating every 4) ===== */
body.theme-light .library > *:nth-child(4n+1) .card,
body.theme-light .library > *:nth-child(4n+1) .bias-card,
body.theme-light .library > *:nth-child(4n+1) .f-card{
  border-color: #e8c2ca; /* velvet edge */
}
body.theme-light .library > *:nth-child(4n+1) .card::before,
body.theme-light .library > *:nth-child(4n+1) .bias-card::before,
body.theme-light .library > *:nth-child(4n+1) .f-card::before{
  background:
    radial-gradient(540px 340px at 12% 10%, rgba(176,22,34,.10), transparent 66%),
    linear-gradient(120deg, rgba(176,22,34,.06), rgba(176,22,34,0) 62%);
}

body.theme-light .library > *:nth-child(4n+2) .card,
body.theme-light .library > *:nth-child(4n+2) .bias-card,
body.theme-light .library > *:nth-child(4n+2) .f-card{
  border-color: #eadbb7; /* gold edge */
}
body.theme-light .library > *:nth-child(4n+2) .card::before,
body.theme-light .library > *:nth-child(4n+2) .bias-card::before,
body.theme-light .library > *:nth-child(4n+2) .f-card::before{
  background:
    radial-gradient(540px 340px at 12% 10%, rgba(214,180,107,.14), transparent 66%),
    linear-gradient(120deg, rgba(214,180,107,.08), rgba(214,180,107,0) 62%);
}

body.theme-light .library > *:nth-child(4n+3) .card,
body.theme-light .library > *:nth-child(4n+3) .bias-card,
body.theme-light .library > *:nth-child(4n+3) .f-card{
  border-color: #cfe7e1; /* menthol edge */
}
body.theme-light .library > *:nth-child(4n+3) .card::before,
body.theme-light .library > *:nth-child(4n+3) .bias-card::before,
body.theme-light .library > *:nth-child(4n+3) .f-card::before{
  background:
    radial-gradient(540px 340px at 12% 10%, rgba(14,77,70,.12), transparent 66%),
    linear-gradient(120deg, rgba(14,77,70,.07), rgba(14,77,70,0) 62%);
}

body.theme-light .library > *:nth-child(4n+4) .card,
body.theme-light .library > *:nth-child(4n+4) .bias-card,
body.theme-light .library > *:nth-child(4n+4) .f-card{
  border-color: #dfc0cf; /* wine edge */
}
body.theme-light .library > *:nth-child(4n+4) .card::before,
body.theme-light .library > *:nth-child(4n+4) .bias-card::before,
body.theme-light .library > *:nth-child(4n+4) .f-card::before{
  background:
    radial-gradient(540px 340px at 12% 10%, rgba(60,16,36,.11), transparent 66%),
    linear-gradient(120deg, rgba(60,16,36,.06), rgba(60,16,36,0) 62%);
}

/* Difficulty pill stays readable on light backgrounds */
body.theme-light .f-card .pill{
  background: rgba(0,0,0,.06);
  color:#111827;
}

/* Ensure text contrast inside library cards */
body.theme-light .library .card h3,
body.theme-light .library .bias-card h3{ color:#0f172a; }
body.theme-light .library .card .lead,
body.theme-light .library .bias-card .lead{ color:#4a4f57; }
/* =========================
   LIGHT MODE — Library: cohesive red/green wash,
   no harsh white fade, smooth edge
   ========================= */

   body.theme-light .library{
    background: linear-gradient(180deg,#f7f7f8,#eef0f4);
    row-gap: 18px;
    column-gap: 18px;
  }
  
  /* Base card stays clean white; color lives in an overlay (::before) */
  body.theme-light .library .f-card{
    position: relative;
    background:
      radial-gradient(140% 100% at 20% 0%, rgba(0,0,0,.03), rgba(0,0,0,0) 60%),
      linear-gradient(180deg, #ffffff, #fafbfc);
    border: 1px solid #dfe3eb;
    box-shadow: 0 14px 34px rgba(10,20,30,.06);
    overflow: hidden;
    transition: transform .15s ease, border-color .25s ease, box-shadow .25s ease;
  }
  
  /* The tint overlay (no white veil). We fade it with a MASK, not white paint. */
  body.theme-light .library .f-card::before{
    content:"";
    position:absolute; inset:0;
    pointer-events:none;
    /* two-part wash: subtle top-left glow + diagonal tint */
    background:
      radial-gradient(520px 320px at 12% 10%, rgba(255,255,255,.06), transparent 65%),
      linear-gradient(135deg, var(--tint, rgba(176,22,34,.16)) 0%, transparent 68%);
    /* smooth fade to the right without making things "whiter" */
    -webkit-mask-image: linear-gradient(90deg, #000 0%, #000 82%, rgba(0,0,0,.7) 92%, transparent 100%);
            mask-image: linear-gradient(90deg, #000 0%, #000 82%, rgba(0,0,0,.7) 92%, transparent 100%);
    opacity:.95; /* stronger than before but still tasteful */
    mix-blend-mode:multiply;
  }
  
  /* Hover: a hair more depth; keep palette consistent */
  body.theme-light .library .f-card:hover{
    transform: translateY(-2px);
    border-color: #d3d8e4;
    box-shadow:
      0 0 0 3px rgba(176,22,34,.05),
      0 22px 40px rgba(10,20,30,.12);
  }
  
  /* ========= Palette control: mostly reds & greens =========
     If you don’t have category data-attributes, alternate by position.
     (odd = velvet red, even = bottle green)
  */
  body.theme-light .library > *:nth-child(odd) .f-card { --tint: rgba(176,22,34,.16); } /* velvet red */
  body.theme-light .library > *:nth-child(even) .f-card{ --tint: rgba(31,74,59,.16); }  /* bottle green */
  
  /* Optional: strengthen every 3rd card slightly, still red/green family */
  body.theme-light .library > *:nth-child(6n+3) .f-card { --tint: rgba(176,22,34,.20); }
  body.theme-light .library > *:nth-child(6n+6) .f-card { --tint: rgba(31,74,59,.20); }
  
  /* Difficulty pill readable */
  body.theme-light .f-card .pill{
    background: rgba(0,0,0,.06);
    color:#111827;
  }
  
  /* Titles/meta contrast stays strong on light cards */
  body.theme-light .library .f-card h3{ color:#0f172a; }
  body.theme-light .library .f-card .lead{ color:#4a4f57; }
  /* === LIGHT MODE — kill the big white fade on the right of Library cards === */

/* 1) Push the fade almost to the edge (last 1–2% only).
      If you want literally zero fade, set mask-image: none; */
body.theme-light .library .f-card::before{
  /* keep your existing background, but change the mask: */
  -webkit-mask-image: linear-gradient(90deg,
      #000 0%,               /* fully visible */
      #000 97.5%,            /* keep visible until the very end */
      rgba(0,0,0,.85) 99%,   /* gentle taper */
      transparent 100%       /* quick fade in the last sliver */
  );
          mask-image: linear-gradient(90deg,
      #000 0%,
      #000 97.5%,
      rgba(0,0,0,.85) 99%,
      transparent 100%
  );
  opacity: .98;              /* slightly stronger wash so the edge isn't glaring */
}

/* 2) Add a subtle right-edge vignette (not a white wall),
      so the tint ends gracefully without looking abrupt */
body.theme-light .library .f-card::after{
  content:"";
  position:absolute; inset:0;
  pointer-events:none;
  background: linear-gradient(90deg,
    transparent 0%,
    transparent 96%,
    rgba(0,0,0,.035) 100%   /* whisper-dark, not white */
  );
  mix-blend-mode: multiply;
}

/* 3) (Optional) Nudge tint strength a touch so full-bleed looks intentional */
body.theme-light .library > *:nth-child(odd) .f-card { --tint: rgba(176,22,34,.18); } /* velvet red */
body.theme-light .library > *:nth-child(even) .f-card{ --tint: rgba(31,74,59,.18); }  /* bottle green */
